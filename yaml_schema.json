import importlib
from typing import Callable, Dict, List

_CLASS_REGISTRY: Dict[str, List[str]] = {
    "app.spec.kafka.subject": ["Subject"]
}


def resolve_class(name: str) -> Callable:
    result = next(
        ((key, name) for key, values in _CLASS_REGISTRY.items() if name in values),
        None
    )
    if not result:
        raise ValueError(f"Unknown function in _CLASS_REGISTRY : {name}")
    module_name, attr = result
    module = importlib.import_module(module_name)
    return getattr(module, attr)
